/*! BusBoardingMap 2016-03-26 */
"use strict";L.BusMainControl={},L.BusMainControl.legend=function(a,b){return new L.BusMainControl.ColourLegend(a,b)},L.BusMainControl.ColourLegend=L.Control.extend({options:{position:"bottomleft"},initialize:function(a,b){L.Util.setOptions(this,b),this.colourRange=a},onAdd:function(a){this.container=L.DomUtil.create("div","busmain_legend"),this._Title="<div class='legend-title'>RiderShip Range</div>",this._LegendScale=L.DomUtil.create("div","legend-scale"),this._LegendLabels=L.DomUtil.create("ul","legend-labels",this._LegendScale),$(this.container).append(this._Title,this._LegendScale);for(var b=0;b<this.colourRange.length;b++){var c="<li><span style='background:"+this.colourRange[b].ColourCode+";'></span>"+this.colourRange[b].MaxCapacity+"~"+this.colourRange[b].MinCapacity+"</li>";$(this._LegendLabels).append(c)}return this.container}}),L.BusMainControl.slider=function(a,b){return new L.BusMainControl.DateSlider(a,b)},L.BusMainControl.DateSlider=L.Control.extend({options:{position:"bottomright"},initialize:function(a,b,c){L.Util.setOptions(this,c),this._controlJson=b,this._callback=a},onAdd:function(a){return this.container=L.DomUtil.create("div","busmain_slider"),this._MainSlider=L.DomUtil.create("input","slider_main"),$(this._MainSlider).attr("type","range"),$(this._MainSlider).attr("min","1"),$(this._MainSlider).attr("max",(this._controlJson.To-this._controlJson.From+1)*this._controlJson.Ranges.length),$(this._MainSlider).attr("value","0"),L.DomEvent.on(this._MainSlider,"change",function(a){this._callback(this._changeValue(this._MainSlider.value))},this),$(this.container).append(this._MainSlider),L.DomEvent.disableClickPropagation(this.container),this.container},_changeValue:function(a){for(var b=this._controlJson.To-this._controlJson.From+2,c=1,d=1970,e=1;b>c;)if(this._controlJson.Ranges.length*c>=a&&a>=this._controlJson.Ranges.length*(c-1)){for(var f=this._controlJson.Ranges.length*(c-1)+1;f<this._controlJson.Ranges.length*c+1;f++)if(parseInt(a)===f){d=parseInt(this._controlJson.From)+(c-1),e=(c-1)*this._controlJson.Ranges.length;break}c++}else c++;var g={};return g.Year=d,g.Month=this._controlJson.Ranges[a-e-1],g}}),L.BusMainControl.dateview=function(a){return new L.BusMainControl.DateView(a)},L.BusMainControl.DateView=L.Control.extend({options:{position:"topleft"},initialize:function(a){L.Util.setOptions(this,a)},onAdd:function(a){return this.container=L.DomUtil.create("div","busmain_dateview"),this._MainText=L.DomUtil.create("h1","dateViewText"),$(this.container).append(this._MainText),this.container},ChangeValue:function(a){$(this._MainText).html("Year: "+a.Year+"<br>Month: "+a.Month)}}),L.BusMainControl.ridership=function(a,b){return new L.BusMainControl.RidershipView(a,b)},L.BusMainControl.RidershipView=L.Control.extend({options:{position:"topright"},initialize:function(a,b){L.Util.setOptions(this,b),this._TotalJson=a},onAdd:function(a){return this.container=L.DomUtil.create("div","busmain_ridershipView"),this._Legend=L.DomUtil.create("h2","ridershipViewLegend"),this._MainText=L.DomUtil.create("h1","ridershipViewText"),$(this.container).append(this._Legend),$(this.container).append(this._MainText),this.container},ChangeValue:function(a){$(this._Legend).text("Total RiderShip"),$(this._MainText).text(this._TotalJson[a.Year][a.Month])}});